steps:
  
  - name: 'gcr.io/cloud-builders/git'
    args: ['clone','https://github.com/Divyesh-123/task-clusterrepo.git']

  - name: 'gcr.io/cloud-builders/docker'
    entrypoint: 'bash'
    args: ['-c', 'docker login --username=marutidock --password=Mtech@123']
    # secretEnv: ['USERNAME', 'PASSWORD']

  - name: 'gcr.io/cloud-builders/gcloud'
    args: ['container', 'clusters', 'get-credentials', 'task-cluster' '--zone=us-central1-a --project=high-apricot-342105']
    
    
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t','gcpimg', '.']

  - name: 'gcr.io/cloud-builders/docker'
    args: ['tag','gcpimg','marutidock/flask_gcp']

  - name: 'gcr.io/cloud-builders/docker'
    args: ['push','marutidock/flask_gcp']

  
  # # Docker Build
  # - name: 'gcr.io/cloud-builders/docker'
  #   args: ['build', '-t','us-central1-docker.pkg.dev/${PROJECT_ID}/my-docker-repo/myimage1','.']

  # # Docker Push
  # - name: 'gcr.io/cloud-builders/docker'
  #   args: ['push', 
  #          'us-central1-docker.pkg.dev/${PROJECT_ID}/my-docker-repo/myimage1']

  - name: 'gcr.io/cloud-builders/kubectl'
    args: ['create','-f','dockerhub-dply.yaml']

